---
navigation: true
title: Adguard CIDRE
main:
  fluid: false
---
:ellipsis{left=0px width=40rem top=10rem blur=140px}
# ü§ñ Adguard CIDRE Sync
---

Adguard Home est une solution merveilleuse pour filter ses requ√™tes DNS et ainsi se d√©barasser de la publicit√© ou des DNS des fournisseurs d'acc√®s, ou encore r√©√©crire des requetes.

Quand c'est en local, c'est tr√®s chouette. Mais quand on veut que tout ses appareils en profitent m√™me √† l'exterieur, on est oblig√© de l'exposer sur le net. Et n'importe qui peut s'en servir et saturer le petit remote √† 1‚Ç¨ qu'on a pris pour l'heberger.

Adguard permet d'avoir des listes de clients autoris√©s ou bloqu√©s. Probl√®me, pour autoriser un client il faut son IP, et dans le cas d'un t√©l√©phone sur le r√©seau mobile, beh elle change r√©guli√®rement. L'id√©e est donc plutot de bloquer des listes g√©n√©rales plutot que d'autoriser des IP qui de toute fa√ßon changent r√©guli√®rement.

CIDRE est un outil qui permet de synchroniser des listes de plages IP g√©olocalis√©es mises √† jour r√©guli√®rement avec un pare feu. Plutot que de faire tourner CIDRE sur le remote complet avec des r√®gles de pare feu complexes, je me suis dit qu'il fallait simplement s'arranger pour ajouter les plages IP √† jour que CIDRE propose au systeme de block list d'adguard, selon les pays que l'on souhaite bloquer.

C'est ainsi qu'est n√© Adguard CIDRE Sync, un conteneur qui synchronise r√©guli√®rement la block list d'Adguard avec les plages IP recens√©es par CIDRE √† la fr√©quence que vous voulez.

L'id√©e etant de :
- Backup le fichier de conf d'Adguard au premier lancement (le fichier jamais touch√© par le robot est ainsi conserv√© au cas o√π)
- T√©l√©charger la liste des pays selectionn√©s via une variable d'environnement
- Permettre d'ajouter soi-meme des IP "√† la main" dans un fichier
- Concat√©ner le tout, backup le fichier de conf (derni√®re update), et injecter la liste dans la bonne section du fichier de conf d'Adguard
- Recharger Adguard en relan√ßant le container (acc√®s au socket via docker socket proxy pour limiter les permissions)

Tout ceci de mani√®re compl√®tement autonome, avec une fr√©quence choisie en variable d'environnement dans la conf du compose.

Plus d'infos directement sur le repo :

 
  ::card
  #title
    üêã __Adguard CIDRE Sync__
  #description
  [Robot de synchronisation de la blocklist d'Adguard](https://git.djeex.fr/Djeex/adguard-cidre)
  ::
